```sql
-- 자동차 종류 별 특정 옵션이 포함된 자동차 수 구하기
SELECT CAR_TYPE, COUNT(*) AS CARS
FROM CAR_RENTAL_COMPANY_CAR
WHERE OPTIONS LIKE '%통풍시트%' OR  OPTIONS LIKE '%열선시트%' OR  OPTIONS LIKE '%가죽시트%' 
GROUP BY CAR_TYPE
ORDER BY CAR_TYPE ASC

-- 저자 별 카테고리 별 매출액 집계하기
SELECT B.AUTHOR_ID, AUTHOR_NAME, CATEGORY, SUM(SALES * PRICE) AS TOTAL_SALES
FROM BOOK B, AUTHOR A, BOOK_SALES
WHERE B.AUTHOR_ID = A.AUTHOR_ID
AND B.BOOK_ID = BOOK_SALES.BOOK_ID
AND TO_CHAR(SALES_DATE , 'YYYYMM') = '202201'
GROUP BY B.AUTHOR_ID, AUTHOR_NAME, CATEGORY
ORDER BY AUTHOR_ID ASC, CATEGORY DESC

-- 카테고리 별 도서 판매량 집계하기
SELECT CATEGORY, SUM(SALES) AS TOTAL_SALES
FROM BOOK A, BOOK_SALES B
WHERE  B.BOOK_ID = A.BOOK_ID
AND TO_CHAR(SALES_DATE , 'YYYYMM') = '202201'
GROUP BY CATEGORY
ORDER BY CATEGORY 

-- 상품을 구매한 회원 비율 구하기
SELECT TO_CHAR(HIST.SALES_DATE, 'YYYY') AS YEAR,
    TO_NUMBER(TO_CHAR(HIST.SALES_DATE, 'MM')) AS MONTH,
    --TO_CHAR(HIST.SALES_DATE, 'FMMM') AS MONTH, -- 이건 왜 안되는 걸까??
    COUNT(distinct HIST.USER_ID) AS PUCHASED_USERS,
    ROUND(COUNT(distinct HIST.USER_ID) / (SELECT COUNT(USER_ID)    FROM USER_INFO    WHERE TO_CHAR(JOINED, 'YYYY') ='2021') ,1) AS PUCHASED_RATIO
FROM USER_INFO USR, ONLINE_SALE HIST
WHERE HIST.USER_ID = USR.USER_ID
AND TO_CHAR(JOINED, 'YYYY') ='2021'
GROUP BY TO_CHAR(HIST.SALES_DATE, 'YYYY'), TO_NUMBER(TO_CHAR(HIST.SALES_DATE, 'MM'))
ORDER BY YEAR, MONTH

-- 모든 레코드 조회하기
SELECT *
FROM ANIMAL_INS
ORDER BY ANIMAL_ID 

-- 역순 정렬하기
SELECT NAME,	DATETIME
FROM ANIMAL_INS
ORDER BY ANIMAL_ID DESC

-- 아픈 동물 찾기
SELECT ANIMAL_ID,	NAME
FROM ANIMAL_INS
WHERE INTAKE_CONDITION = 'Sick'
ORDER BY ANIMAL_ID

-- 어린 동물 찾기 
SELECT ANIMAL_ID,	NAME
FROM ANIMAL_INS
WHERE INTAKE_CONDITION <> 'Aged'
ORDER BY ANIMAL_ID

-- 고양이와 개는 몇 마리 있을까
SELECT ANIMAL_TYPE, COUNT(*) AS	count
FROM ANIMAL_INS
GROUP BY ANIMAL_TYPE
ORDER BY ANIMAL_TYPE

-- 동명 동물 수 찾기
SELECT NAME, COUNT(*) AS COUNT
FROM ANIMAL_INS
WHERE NAME IS NOT NULL
GROUP BY NAME
HAVING COUNT(*) > 1
ORDER BY NAME

-- 오랜 기간 보호한 동물(1)
SELECT NAME, DATETIME
FROM (
  SELECT NAME, DATETIME, RANK() OVER(ORDER BY DATETIME) AS RN
    FROM ANIMAL_INS 
    WHERE ANIMAL_ID NOT IN (SELECT ANIMAL_ID FROM ANIMAL_OUTS)    
)
WHERE RN < 4
ORDER BY DATETIME 

-- join으로 풀기
SELECT NAME, DATETIME
FROM (
  SELECT I.NAME, I.DATETIME, RANK() OVER(ORDER BY I.DATETIME) AS RN
    FROM ANIMAL_INS I, ANIMAL_OUTS O 
    WHERE O.DATETIME IS NULL
    AND I.ANIMAL_ID = O.ANIMAL_ID(+)
)
WHERE RN < 4
ORDER BY DATETIME 

-- 입양 시각 구하기(2)
SELECT B.HOUR, NVL(COUNT,0) AS COUNT
FROM (
    SELECT TO_NUMBER(TO_CHAR(DATETIME, 'HH24')) AS HOUR, COUNT(*) AS COUNT
    FROM ANIMAL_OUTS
    GROUP BY TO_NUMBER(TO_CHAR(DATETIME, 'HH24'))
    ORDER BY TO_NUMBER(TO_CHAR(DATETIME, 'HH24'))
    ) A,
    (SELECT LEVEL-1 AS HOUR FROM DUAL CONNECT BY LEVEL < 25) B
WHERE A.HOUR (+)= B.HOUR
ORDER BY B.HOUR
```  
